<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View on Map Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .test-container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #0056b3; }
        .log { background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; padding: 10px; max-height: 200px; overflow-y: auto; font-family: monospace; font-size: 12px; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ View on Map Function Test</h1>
        
        <div id="function-status" class="status info">Testing viewPlaceOnMapEnhanced function...</div>
        
        <div>
            <h3>Test Functions:</h3>
            <button onclick="testFunctionExists()">üîç Check if Function Exists</button>
            <button onclick="testWithTajMahal()">üïå Test with Taj Mahal (ID: 1)</button>
            <button onclick="testWithRandomPlace()">üé≤ Test with Random Place</button>
            <button onclick="checkConsole()">üìã Open Browser Console</button>
        </div>

        <div id="console-log" class="log">
            Click buttons above to test the view on map functionality...<br>
        </div>
    </div>

    <!-- Include all necessary scripts -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="js/explore.js"></script>

    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('console-log');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? 'red' : type === 'success' ? 'green' : 'black';
            logDiv.innerHTML += `<span style="color: ${color}">[${timestamp}] ${message}</span><br>`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(`[TEST] ${message}`);
        }

        function updateStatus(message, type) {
            const statusDiv = document.getElementById('function-status');
            statusDiv.className = `status ${type}`;
            statusDiv.innerHTML = message;
        }

        function testFunctionExists() {
            log('Testing if viewPlaceOnMapEnhanced function exists...');
            
            if (typeof window.viewPlaceOnMapEnhanced === 'function') {
                updateStatus('‚úÖ viewPlaceOnMapEnhanced function exists and is callable', 'success');
                log('SUCCESS: Function is properly defined in window scope', 'success');
            } else if (typeof viewPlaceOnMapEnhanced === 'function') {
                updateStatus('‚úÖ viewPlaceOnMapEnhanced function exists in global scope', 'success');
                log('SUCCESS: Function is defined in global scope', 'success');
            } else {
                updateStatus('‚ùå viewPlaceOnMapEnhanced function NOT found', 'error');
                log('ERROR: Function is not defined or accessible', 'error');
            }

            // Check for other required components
            const checks = [
                { name: 'INDIAN_TOURIST_PLACES data', exists: typeof INDIAN_TOURIST_PLACES !== 'undefined' && INDIAN_TOURIST_PLACES.length > 0 },
                { name: 'Leaflet library', exists: typeof L !== 'undefined' },
                { name: 'Google Maps callback', exists: typeof window.initMap === 'function' }
            ];

            checks.forEach(check => {
                log(`${check.exists ? '‚úÖ' : '‚ùå'} ${check.name}: ${check.exists ? 'Available' : 'Missing'}`, 
                    check.exists ? 'success' : 'error');
            });
        }

        function testWithTajMahal() {
            log('Testing with Taj Mahal (Place ID: 1)...');
            
            try {
                if (typeof window.viewPlaceOnMapEnhanced === 'function') {
                    log('Calling window.viewPlaceOnMapEnhanced(1)...', 'info');
                    window.viewPlaceOnMapEnhanced(1);
                    log('Function called successfully - check if map scrolled/opened', 'success');
                } else if (typeof viewPlaceOnMapEnhanced === 'function') {
                    log('Calling viewPlaceOnMapEnhanced(1)...', 'info');
                    viewPlaceOnMapEnhanced(1);
                    log('Function called successfully - check if map scrolled/opened', 'success');
                } else {
                    log('Function not available for testing', 'error');
                }
            } catch (error) {
                log(`ERROR calling function: ${error.message}`, 'error');
                console.error('Full error:', error);
            }
        }

        function testWithRandomPlace() {
            log('Testing with a random place...');
            
            if (typeof INDIAN_TOURIST_PLACES === 'undefined' || INDIAN_TOURIST_PLACES.length === 0) {
                log('No places data available for random test', 'error');
                return;
            }

            const randomIndex = Math.floor(Math.random() * INDIAN_TOURIST_PLACES.length);
            const randomPlace = INDIAN_TOURIST_PLACES[randomIndex];
            
            log(`Selected random place: ${randomPlace.name} (ID: ${randomPlace.id})`, 'info');
            
            try {
                if (typeof window.viewPlaceOnMapEnhanced === 'function') {
                    window.viewPlaceOnMapEnhanced(randomPlace.id);
                    log('Random place function called successfully', 'success');
                } else if (typeof viewPlaceOnMapEnhanced === 'function') {
                    viewPlaceOnMapEnhanced(randomPlace.id);
                    log('Random place function called successfully', 'success');
                } else {
                    log('Function not available for testing', 'error');
                }
            } catch (error) {
                log(`ERROR with random place: ${error.message}`, 'error');
            }
        }

        function checkConsole() {
            log('Opening browser console for detailed inspection...', 'info');
            log('In console, you can manually test:', 'info');
            log('- window.viewPlaceOnMapEnhanced(1)', 'info');
            log('- INDIAN_TOURIST_PLACES.length', 'info');
            log('- typeof window.viewPlaceOnMapEnhanced', 'info');
            console.log('=== MANUAL TESTING COMMANDS ===');
            console.log('window.viewPlaceOnMapEnhanced(1)');
            console.log('INDIAN_TOURIST_PLACES.length');
            console.log('typeof window.viewPlaceOnMapEnhanced');
        }

        // Auto-test when page loads
        window.onload = function() {
            setTimeout(() => {
                testFunctionExists();
            }, 1000);
        };
    </script>
</body>
</html>
